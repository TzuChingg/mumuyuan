import{S as F}from"./SelectList-2CYifP3n.js";import{B as I}from"./BackendFunctions-2ce9RJsM.js";import{_ as T,r as x,o as l,c,a as t,s as h,b as m,d as L,F as p,t as b,h as u,l as k,w as _,v,e as g,j as B,T as U,p as V,f as D}from"./index-d3kt-dkl.js";const M={components:{BackendFunctions:I,SelectList:F},data(){return{journey:[],downJourney:[],thisPage:[],thisPage2:[],page:1,pg:12,select:"1",options:[{value:"1",label:"活動管理"},{value:"2",label:"下架活動"}],options2:[{value:"2",label:"下架活動"},{value:"1",label:"活動管理"}],dataForm:{newsImage:"",newsTitle:"",newsContent:"",couponId:"3",isLook:!1},coupons:[]}},computed:{startIndex(){return(this.page-1)*this.pg},endIndex(){return this.startIndex+this.pg}},methods:{prevPage(){this.page>1&&(this.page--,this.select==1?this.updateThisPage():this.select==2&&this.updatePage())},nextPage(){this.thisPage.length>=this.pg&&(this.page++,this.select==1?this.updateThisPage():this.select==2&&this.updatePage())},updateThisPage(){this.thisPage=this.journey.slice(this.startIndex,this.endIndex)},updatePage(){this.thisPage2=this.downJourney.slice(this.startIndex,this.endIndex)},uploadFile(a){const s=a.target.files[0];this.dataForm.image=s},get(a){this.select=a},goDown(a){const s={isLook:!0};this.$axios.patch(`/news/${a}`,s).then(()=>{location.reload()})},goon(a){const s={isLook:!1};this.$axios.patch(`/news/${a}`,s).then(()=>{location.reload()})},update(a,s,f){const y={couponId:`${s}`,newsContent:`${f}`};this.$axios.patch(`/news/${a}`,y).then(()=>{location.reload()})},pushData(){this.$axios.post("/news",this.dataForm).then(()=>{location.reload()})},del(a){this.$axios.delete(`/news/${a}`).then(()=>{location.reload()})}},mounted(){this.$axios.get("/news").then(a=>{a.data.forEach(s=>{s.isLook==!1?this.journey.push({title:s.newsTitle,coupon:s.couponId,newsContent:s.newsContent,id:s.id}):this.downJourney.push({title:s.newsTitle,id:s.id})}),this.updateThisPage(),this.updatePage()}),this.$axios.get("/coupons").then(a=>{a.data.forEach(s=>{s.isLook==!1&&this.coupons.push({title:s.name,id:s.id})})})}},i=a=>(V("data-v-225f80d2"),a=a(),D(),a),S={class:"d-flex"},J={class:"sidebar border-5 pt-3 border-end d-flex bg-secondary flex-column"},N={key:0,class:"main"},E={class:"container mt-6"},j={class:"mt-3"},q={class:"row justify-content-between"},z=i(()=>t("div",{class:"col-2"},[t("button",{type:"button",class:"btn btn-primary","data-bs-toggle":"modal","data-bs-target":"#exampleModal"}," 新增活動 ")],-1)),A={class:"col-2"},G={class:"row row-cols-2 mt-2"},H={class:"card my-4 bg-light"},K={class:"cardbody px-4"},O={class:"text-center my-4 text-nowrap"},Q=["onUpdate:modelValue"],R=["value"],W=["onUpdate:modelValue"],X={class:"row text-center align-items-center py-3"},Y={class:"col-6"},Z=["data-bs-target"],$={class:"col-6"},tt=["data-bs-target"],st=["id"],et={class:"modal-dialog"},ot={class:"modal-content border-0"},at=i(()=>t("div",{class:"modal-body fs-3"},"是否下架折價券?",-1)),dt={class:"modal-footer border-0"},nt=i(()=>t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," 取消 ",-1)),it=["onClick"],lt=["id"],ct={class:"modal-dialog"},rt={class:"modal-content border-0"},bt={class:"modal-body fs-3"},ht={class:"modal-footer border-0"},_t=i(()=>t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," 取消 ",-1)),mt=["onClick"],pt={class:"d-flex justify-content-center h-25 mt-4"},ut=["disabled"],gt={class:"fs-3 text-primary mx-3"},vt=["disabled"],ft={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},yt={class:"modal-dialog"},wt={class:"modal-content"},xt=i(()=>t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"exampleModalLabel"},"活動內容")],-1)),kt={class:"modal-body bg-secondary"},Pt={class:"card border-0 bg-secondary"},Ct={class:"cardbody mt-4"},Ft={class:"d-flex h-25 justify-content-center mt-3"},It={class:"d-flex h-25 justify-content-center mt-5 mb-2"},Tt=i(()=>t("label",{for:"title",class:"fs-3 me-2"},"活動:",-1)),Lt={class:"d-flex h-25 justify-content-center mb-2"},Bt=i(()=>t("label",{for:"title",class:"fs-3 me-2"},"內容:",-1)),Ut={class:"d-flex h-25 justify-content-center mt-3 mb-2"},Vt=["value"],Dt={class:"modal-footer"},Mt=i(()=>t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," 關閉 ",-1)),St={key:1,class:"main"},Jt={class:"container mt-6"},Nt={class:"my-2"},Et={class:"row justify-content-end"},jt={class:"col-2"},qt={class:"row row-cols-4"},zt={class:"card my-4 bg-light"},At={class:"cardbody"},Gt={class:"text-center mt-4 text-nowrap"},Ht={class:"row text-center align-items-center py-3"},Kt={class:"col-6"},Ot=["data-bs-target"],Qt={class:"col-6"},Rt=["data-bs-target"],Wt=["id"],Xt={class:"modal-dialog"},Yt={class:"modal-content border-0"},Zt=i(()=>t("div",{class:"modal-body fs-3"},"是否上架活動?",-1)),$t={class:"modal-footer border-0"},ts=i(()=>t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," 取消 ",-1)),ss=["onClick"],es=["id"],os={class:"modal-dialog"},as={class:"modal-content border-0"},ds=i(()=>t("div",{class:"modal-body fs-3"},"是否刪除活動?",-1)),ns={class:"modal-footer border-0"},is=i(()=>t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," 取消 ",-1)),ls=["onClick"],cs={class:"d-flex justify-content-center h-25 mt-3"},rs=["disabled"],bs={class:"fs-3 text-primary mx-3"},hs=["disabled"];function _s(a,s,f,y,o,d){const P=x("BackendFunctions"),w=x("select-list");return l(),c("div",S,[t("aside",J,[s[0]||(h(-1),s[0]=m(P),h(1),s[0])]),m(U,{name:"fade",mode:"out-in"},{default:L(()=>[o.select==1?(l(),c("main",N,[t("div",E,[t("div",j,[t("div",q,[z,t("div",A,[s[1]||(h(-1),s[1]=m(w,{options:o.options,onUpdata:d.get},null,8,["options","onUpdata"]),h(1),s[1])])])]),t("div",G,[(l(!0),c(p,null,u(o.thisPage,(e,n)=>(l(),c("div",{class:"col",key:n},[t("div",H,[t("div",K,[t("h5",O,b(e.title),1),_(t("select",{class:"form-select mx-auto w-50 shadow-none my-2","aria-label":"Default select example","onUpdate:modelValue":r=>e.coupon=r},[(l(!0),c(p,null,u(o.coupons,(r,C)=>(l(),c("option",{key:C,value:r.id},b(r.title),9,R))),128))],8,Q),[[k,e.coupon]]),_(t("textarea",{id:"title",placeholder:"內容",class:"px-4 form-control border-1 shadow-none w-100",style:{height:"150px"},"onUpdate:modelValue":r=>e.newsContent=r},null,8,W),[[v,e.newsContent]]),t("div",X,[t("div",Y,[t("button",{type:"button",class:"btn btn-danger ms-6","data-bs-toggle":"modal","data-bs-target":"#goDown"+n}," 下架 ",8,Z)]),t("div",$,[t("button",{type:"button",class:"btn btn-primary me-6","data-bs-toggle":"modal","data-bs-target":"#update"+n}," 修改 ",8,tt)])])])]),t("div",{class:"modal fade",id:"goDown"+n,"data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"staticBackdropLabel","aria-hidden":"true"},[g(" 0 "),t("div",et,[t("div",ot,[at,t("div",dt,[nt,t("button",{type:"button",class:"btn btn-primary","data-bs-dismiss":"modal",onClick:r=>d.goDown(e.id)}," 確認 ",8,it)])])])],8,st),t("div",{class:"modal fade",id:"update"+n,"data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"staticBackdropLabel","aria-hidden":"true"},[g(" 0 "),t("div",ct,[t("div",rt,[t("div",bt,"是否修改 "+b(e.title)+" 活動?",1),t("div",ht,[_t,t("button",{type:"button",class:"btn btn-primary","data-bs-dismiss":"modal",onClick:r=>d.update(e.id,e.coupon,e.newsContent)}," 確認 ",8,mt)])])])],8,lt)]))),128))]),t("div",pt,[t("button",{class:"btn btn-primary",onClick:s[2]||(s[2]=(...e)=>d.prevPage&&d.prevPage(...e)),disabled:o.page===1},"上一页",8,ut),t("strong",gt,b(o.page),1),t("button",{class:"btn btn-primary",onClick:s[3]||(s[3]=(...e)=>d.nextPage&&d.nextPage(...e)),disabled:o.thisPage.length<o.pg}," 下一页 ",8,vt)]),t("div",ft,[t("div",yt,[t("div",wt,[xt,t("div",kt,[t("div",Pt,[t("div",Ct,[t("div",Ft,[t("input",{class:"form-control w-50",type:"file",id:"formFile",onChange:s[4]||(s[4]=(...e)=>d.uploadFile&&d.uploadFile(...e))},null,32)]),t("div",It,[Tt,_(t("input",{type:"text",id:"title",placeholder:"活動名",class:"form-control border-1 shadow-none w-50","onUpdate:modelValue":s[5]||(s[5]=e=>o.dataForm.newsTitle=e)},null,512),[[v,o.dataForm.newsTitle]])]),t("div",Lt,[Bt,_(t("textarea",{id:"title",placeholder:"內容",class:"form-control border-1 shadow-none w-50","onUpdate:modelValue":s[6]||(s[6]=e=>o.dataForm.newsContent=e)},null,512),[[v,o.dataForm.newsContent]])]),t("div",Ut,[_(t("select",{class:"form-select w-50 shadow-none","aria-label":"Default select example","onUpdate:modelValue":s[7]||(s[7]=e=>o.dataForm.couponId=e)},[(l(!0),c(p,null,u(o.coupons,(e,n)=>(l(),c("option",{key:n,value:e.id},b(e.title),9,Vt))),128))],512),[[k,o.dataForm.couponId]])])])])]),t("div",Dt,[Mt,t("button",{type:"button",class:"btn btn-primary","data-bs-dismiss":"modal",onClick:s[8]||(s[8]=e=>d.pushData())}," 新增 ")])])])])])])):o.select==2?(l(),c("main",St,[t("div",Jt,[t("div",Nt,[t("div",Et,[t("div",jt,[s[9]||(h(-1),s[9]=m(w,{options:o.options2,onUpdata:d.get},null,8,["options","onUpdata"]),h(1),s[9])])])]),t("div",qt,[(l(!0),c(p,null,u(o.thisPage2,(e,n)=>(l(),c("div",{class:"col",key:n},[t("div",zt,[t("div",At,[t("h5",Gt,b(e.title),1),t("div",Ht,[t("div",Kt,[t("button",{type:"button",class:"btn btn-danger ms-6","data-bs-toggle":"modal","data-bs-target":"#goon"+n}," 上架 ",8,Ot)]),t("div",Qt,[t("button",{type:"button",class:"btn btn-danger me-6","data-bs-toggle":"modal","data-bs-target":"#del"+n}," 刪除 ",8,Rt)])])])]),t("div",{class:"modal fade",id:"goon"+n,"data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"staticBackdropLabel","aria-hidden":"true"},[g(" 0 "),t("div",Xt,[t("div",Yt,[Zt,t("div",$t,[ts,t("button",{type:"button",class:"btn btn-primary","data-bs-dismiss":"modal",onClick:r=>d.goon(e.id)}," 確認 ",8,ss)])])])],8,Wt),t("div",{class:"modal fade",id:"del"+n,"data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"staticBackdropLabel","aria-hidden":"true"},[g(" 0 "),t("div",os,[t("div",as,[ds,t("div",ns,[is,t("button",{type:"button",class:"btn btn-primary","data-bs-dismiss":"modal",onClick:r=>d.del(e.id)}," 確認 ",8,ls)])])])],8,es)]))),128))]),t("div",cs,[t("button",{class:"btn btn-primary",onClick:s[10]||(s[10]=(...e)=>d.prevPage&&d.prevPage(...e)),disabled:o.page===1},"上一页",8,rs),t("strong",bs,b(o.page),1),t("button",{class:"btn btn-primary",onClick:s[11]||(s[11]=(...e)=>d.nextPage&&d.nextPage(...e)),disabled:o.thisPage.length<o.pg}," 下一页 ",8,hs)])])])):B("",!0)]),_:1})])}const gs=T(M,[["render",_s],["__scopeId","data-v-225f80d2"]]);export{gs as default};
