import{_ as f,g,c as r,a as t,t as a,F as m,h as x,o as h,p as y,f as v}from"./index-d3kt-dkl.js";const I={data(){return{userInfo:{},coupons:[],choose:{}}},created(){this.$axios.get("/coupons?isLook=true").then(s=>{this.coupons=s.data,this.getUserInfo()})},methods:{getUserInfo(){this.$axios.get(`/users/${g.getItem("id")}`).then(s=>{this.userInfo=s.data})},chooseDiscount(s){this.choose=s},confirm(s){const{id:c,name:p,calc:_,image:e,description:i}=s,o=this.userInfo.point-s.point,l=new Date;let d=l.setDate(l.getDate()+7);d=new Date(d).toLocaleDateString();let u=this.userInfo.coupon;u.push({name:p,calc:_,image:e,description:i,expiryDate:d,id:c}),this.$axios.patch(`/users/${this.userInfo.id}`,{point:o,coupon:u}).then(b=>{b.status===200&&(this.getUserInfo(),this.$swal({icon:"success",title:"兌換成功",text:"請確認兌換券",timer:1500}))}).catch(()=>{this.$swal({icon:"error",title:"兌換失敗",text:"請稍後再試",timer:3e3})})}}},n=s=>(y("data-v-22548c27"),s=s(),v(),s),w=n(()=>t("h3",{class:"text-center text-dark",style:{"font-weight":"600","letter-spacing":"2px"}},"點數兌換",-1)),k=n(()=>t("hr",null,null,-1)),D={class:"row justify-content-center memberexchange"},C={class:"col-12 mb-4"},L={class:"fw-bolder px-2",style:{"letter-spacing":"1px",color:"#d73e2dd4"}},M=n(()=>t("hr",null,null,-1)),S={class:"d-flex flex-wrap"},$=["src"],j={class:"card-body p-2 bg-light"},B={class:"fw-bolder fs-5 text-dark mb-2"},U={class:"text-start mb-3 text-dark",style:{"font-size":"18px","font-weight":"600"}},E={class:"row d-flex justify-content-center"},F={class:"col-auto"},z=["onClick","disabled"],N={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},V={class:"modal-dialog modal-dialog-centered"},q={class:"modal-content"},A=n(()=>t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"exampleModalLabel"},"點數兌換"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),G={class:"modal-body"},H={class:"modal-footer"},J=n(()=>t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," 取消 ",-1));function K(s,c,p,_,e,i){return h(),r(m,null,[w,k,t("div",D,[t("div",C,[t("h5",L,"會員點數："+a(e.userInfo.point)+" 點",1),M,t("div",S,[(h(!0),r(m,null,x(e.coupons,o=>(h(),r("div",{class:"mb-4 col-lg-4 col-6 p-2",key:o.name},[t("img",{src:`./木木苑食材修圖/${o.image}.jpg`,class:"card-img-top",alt:"折價券"},null,8,$),t("div",j,[t("h5",B,"優惠方式 : "+a(o.name),1),t("p",U,"需求點數 : "+a(o.point)+" 點",1),t("div",E,[t("div",F,[t("button",{type:"button",class:"btn btn-primary items-center","data-bs-toggle":"modal","data-bs-target":"#exampleModal",onClick:l=>i.chooseDiscount(o),disabled:e.userInfo.point<o.point}," 兌換 ",8,z)])])])]))),128))]),t("div",N,[t("div",V,[t("div",q,[A,t("div",G," 是否使用 "+a(e.choose.point)+" 點兌換 "+a(e.choose.name)+" 1 "+a(e.choose.unit),1),t("div",H,[J,t("button",{type:"button",class:"btn btn-primary",onClick:c[0]||(c[0]=o=>i.confirm(e.choose)),"data-bs-dismiss":"modal"}," 確認 ")])])])])])])],64)}const Q=f(I,[["render",K],["__scopeId","data-v-22548c27"]]);export{Q as default};
