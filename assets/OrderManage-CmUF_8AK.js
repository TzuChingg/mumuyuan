import{B as x}from"./BackendFunctions-2ce9RJsM.js";import{S}from"./SelectList-2CYifP3n.js";import{_ as B,r as w,o as _,c as h,a as s,s as f,b as m,d as C,F as y,t as a,h as g,e as l,j as F,T as N,p as I,f as O}from"./index-d3kt-dkl.js";const E={components:{BackendFunctions:x,SelectList:S},data(){return{order:[],finishorder:[],select:"1",options:[{value:"1",label:"待確認訂單"},{value:"2",label:"待完成訂單"}],options2:[{value:"2",label:"待完成訂單"},{value:"1",label:"待確認訂單"}],socket:null,messages:[]}},computed:{},methods:{ok(i,n,t){const u={status:2},e={userId:n,orderId:i},r=2;this.$axios.post("notice",e).then(()=>this.$axios.patch(`/orders/${i}`,u)).then(()=>{location.reload()}).catch(b=>{console.error(b.response)}),this.socket.send(JSON.stringify({status:r,num:t,userId:n}))},reject(i){this.$axios.delete(`/orders/${i}`).then(()=>{location.reload()})},get(i){this.select=i},pushForCustomer(i,n,t){const u={status:3},e=3;this.$axios.patch(`/orders/${i}`,u).then(()=>{location.reload()}).catch(()=>{}),this.socket.send(JSON.stringify({status:e,num:t,userId:n}))}},mounted(){this.$axios.get("/orders").then(n=>{n.data.forEach(t=>{const u=[];let e="",r="";t.product.forEach(b=>{u.push(b.productName+"X"+b.quantity)}),t.flavor==1?e="梅粉":t.flavor==2?e="秘粉":t.flavor==3&&(e="椒鹽"),t.spicy==1?r="不辣":t.spicy==2?r="小辣":t.spicy==3&&(r="大辣"),t.status==1?this.order.push({name:t.name,phone:t.phone,tableware:t.tableware,bags:t.bags,way:t.type,time:t.pickTime,payment:t.payment,remark:t.comment,total:t.price,product:u,flavor:e,spicy:r,day:t.day,id:t.id,orderNum:t.orderid,status:t.status,isMember:t.isMember,userId:t.userId,orderScore:t.orderScore}):t.status==2&&this.finishorder.push({name:t.name,phone:t.phone,tableware:t.tableware,bags:t.bags,way:t.type,time:t.pickTime,payment:t.payment,remark:t.comment,total:t.price,product:u,flavor:e,spicy:r,day:t.day,id:t.id,orderNum:t.orderid,status:t.status,isMember:t.isMember,userId:t.userId,orderScore:t.orderScore})})});const i="wss://mumuyuan-server.zeabur.app/ws";this.socket=new WebSocket(i)},beforeUnmount(){this.socket&&this.socket.close()}},d=i=>(I("data-v-778771c3"),i=i(),O(),i),T={class:"d-flex"},j={class:"sidebar border-5 border-end d-flex bg-secondary flex-column"},L={key:0,class:"main container"},M={class:"w-25 mt-5"},U={class:"card-body"},V=["id"],$={class:"accordion-item"},D=["id"],J=["data-bs-target","aria-controls"],q={class:"me-5 fs-4"},z={class:"ms-5 mt-11 fs-4"},W={class:"ms-5 mt-11 fs-4"},X=["id","aria-labelledby","data-bs-parent"],A={class:"accordion-body"},G={class:"row row-cols-2"},H={class:"col d-flex flex-wrap h-25"},K={class:"row text-center h-25 w-100"},P={class:"col"},Q={class:"table table-striped align-middle table-sm h-100"},R={class:"fs-5"},Y=d(()=>s("strong",null,"口味:",-1)),Z={class:"fs-5"},ss=d(()=>s("strong",null,"辣度:",-1)),ts={class:"fs-5"},os=d(()=>s("strong",null,"是否要餐具:",-1)),as={class:"fs-5"},ds=d(()=>s("strong",null,"是否要加購提袋:",-1)),cs={class:"fs-5"},ls=d(()=>s("strong",null,"訂購方式:",-1)),ns={class:"fs-5"},es=d(()=>s("strong",null,"預計取餐時間:",-1)),is={class:"text-danger"},rs={class:"fs-5"},_s=d(()=>s("strong",null,"付款方式:",-1)),hs={class:"fs-5"},us=d(()=>s("strong",null,"總金額:",-1)),bs={class:"fs-5"},ps=d(()=>s("strong",null,"備註:",-1)),fs=["data-bs-target"],ms=["data-bs-target"],ys=["id"],gs={class:"modal-dialog"},vs={class:"modal-content border-0"},ks=d(()=>s("div",{class:"modal-body fs-3"},"是否接受訂單?",-1)),ws={class:"modal-footer border-0"},xs=d(()=>s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," 取消 ",-1)),Ss=["onClick"],Bs=["id"],Cs={class:"modal-dialog"},Fs={class:"modal-content border-0"},Ns=d(()=>s("div",{class:"modal-body fs-3"},"是否拒絕訂單?",-1)),Is={class:"modal-footer border-0"},Os=d(()=>s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," 取消 ",-1)),Es=["onClick"],Ts={key:1,class:"main container"},js={class:"w-25 mt-5"},Ls={class:"card-body"},Ms={class:"accordion accordion-flush",id:"accordionFlushExample"},Us={class:"accordion-item"},Vs=["id"],$s=["data-bs-target"],Ds={class:"me-5 fs-4"},Js={class:"ms-5 mt-11 fs-4"},qs=["id","aria-labelledby"],zs={class:"accordion-body"},Ws={class:"row row-cols-2"},Xs={class:"col d-flex flex-wrap h-25"},As={class:"row row-cols-4 text-center h-25 w-100"},Gs={class:"col"},Hs={class:"table table-striped align-middle table-sm h-100"},Ks={class:"fs-5"},Ps=d(()=>s("strong",null,"口味:",-1)),Qs={class:"fs-5"},Rs=d(()=>s("strong",null,"辣度:",-1)),Ys={class:"fs-5"},Zs=d(()=>s("strong",null,"是否要餐具:",-1)),st={class:"fs-5"},tt=d(()=>s("strong",null,"是否要加購提袋:",-1)),ot={class:"fs-5"},at=d(()=>s("strong",null,"訂購方式:",-1)),dt={class:"fs-5"},ct=d(()=>s("strong",null,"預計取餐時間:",-1)),lt={class:"text-danger"},nt={class:"fs-5"},et=d(()=>s("strong",null,"付款方式:",-1)),it={class:"fs-5"},rt=d(()=>s("strong",null,"總金額:",-1)),_t={class:"fs-5"},ht=d(()=>s("strong",null,"備註:",-1)),ut=["data-bs-target"],bt=["id"],pt={class:"modal-dialog"},ft={class:"modal-content border-0"},mt=d(()=>s("div",{class:"modal-body fs-3"},"是否完成訂單?",-1)),yt={class:"modal-footer border-0"},gt=d(()=>s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," 取消 ",-1)),vt=["onClick"];function kt(i,n,t,u,e,r){const b=w("BackendFunctions"),k=w("select-list");return _(),h("div",T,[s("aside",j,[n[0]||(f(-1),n[0]=m(b),f(1),n[0])]),m(N,{name:"fade",mode:"out-in"},{default:C(()=>[e.select==1?(_(),h("main",L,[s("div",M,[n[1]||(f(-1),n[1]=m(k,{options:e.options,onUpdata:r.get},null,8,["options","onUpdata"]),f(1),n[1])]),(_(!0),h(y,null,g(e.order,(o,c)=>(_(),h("div",{class:"card mt-2 shadow-sm w-100 mb-3",key:c},[s("div",U,[s("div",{class:"accordion accordion-flush",id:"accordionFlushExample"+c},[s("div",$,[s("h2",{class:"accordion-header",id:"flush-heading"+c},[s("button",{class:"accordion-button collapsed shadow-none",type:"button","data-bs-toggle":"collapse","data-bs-target":"#flush-collapseOne"+c,"aria-expanded":"false","aria-controls":"flush-collapseOne"+c},[s("strong",q,a(o.name),1),s("span",z,"手機:"+a(o.phone),1),s("span",W,"日期:"+a(o.day),1)],8,J)],8,D),s("div",{id:"flush-collapseOne"+c,class:"accordion-collapse collapse","aria-labelledby":"flush-heading"+c,"data-bs-parent":"#accordionFlushExample"+c},[s("div",A,[s("div",G,[s("div",H,[s("div",K,[(_(!0),h(y,null,g(o.product,(p,v)=>(_(),h("div",{class:"col-4 fs-4 text-nowrap",key:v},a(p),1))),128))])]),s("div",P,[s("table",Q,[s("tbody",null,[s("tr",null,[s("td",R,[Y,l(a(o.flavor),1)])]),s("tr",null,[s("td",Z,[ss,l(a(o.spicy),1)])]),s("tr",null,[s("td",ts,[os,l(a(o.tableware?"要":"不要"),1)])]),s("tr",null,[s("td",as,[ds,l(a(o.bags?"要":"不要"),1)])]),s("tr",null,[s("td",cs,[ls,l(a(o.way?"自取":"外送"),1)])]),s("tr",null,[s("td",ns,[es,s("span",is,a(o.time),1)])]),s("tr",null,[s("td",rs,[_s,l(a(o.payment?"現金":"線上付款"),1)])]),s("tr",null,[s("td",hs,[us,l(a(o.total),1)])]),s("tr",null,[s("td",bs,[ps,l(a(o.remark),1)])])]),s("tfoot",null,[s("button",{type:"btn",class:"btn btn-primary w-100 mb-1","data-bs-toggle":"modal","data-bs-target":"#ok"+c}," 接受 ",8,fs),s("button",{type:"btn",class:"btn btn-primary w-100 mt-1","data-bs-toggle":"modal","data-bs-target":"#reject"+c}," 拒絕 ",8,ms)])])])])])],8,X)])],8,V),s("div",{class:"modal fade",id:"ok"+c,"data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"staticBackdropLabel","aria-hidden":"true"},[l(" 0 "),s("div",gs,[s("div",vs,[ks,s("div",ws,[xs,s("button",{type:"button",class:"btn btn-primary","data-bs-dismiss":"modal",onClick:p=>r.ok(o.id,o.userId,o.orderNum)}," 確認 ",8,Ss)])])])],8,ys),s("div",{class:"modal fade",id:"reject"+c,"data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"staticBackdropLabel","aria-hidden":"true"},[l(" 0 "),s("div",Cs,[s("div",Fs,[Ns,s("div",Is,[Os,s("button",{type:"button",class:"btn btn-primary","data-bs-dismiss":"modal",onClick:p=>r.reject(o.id)}," 確認 ",8,Es)])])])],8,Bs)])]))),128))])):e.select==2?(_(),h("main",Ts,[s("div",js,[n[2]||(f(-1),n[2]=m(k,{options:e.options2,onUpdata:r.get},null,8,["options","onUpdata"]),f(1),n[2])]),(_(!0),h(y,null,g(e.finishorder,(o,c)=>(_(),h("div",{class:"card mt-2 shadow-sm w-100",key:c},[s("div",Ls,[s("div",Ms,[s("div",Us,[s("h2",{class:"accordion-header",id:"flush-heading"+c},[s("button",{class:"accordion-button collapsed shadow-none",type:"button","data-bs-toggle":"collapse","data-bs-target":"#flush-collapseOne"+c,"aria-expanded":"false","aria-controls":"flush-collapseOne"},[s("strong",Ds,a(o.name),1),s("span",Js,"手機:"+a(o.phone),1)],8,$s)],8,Vs),s("div",{id:"flush-collapseOne"+c,class:"accordion-collapse collapse","aria-labelledby":"flush-heading"+c,"data-bs-parent":"#accordionFlushExample"},[s("div",zs,[s("div",Ws,[s("div",Xs,[s("div",As,[(_(!0),h(y,null,g(o.product,(p,v)=>(_(),h("div",{class:"col-4 fs-4 text-nowrap",key:v},a(p),1))),128))])]),s("div",Gs,[s("table",Hs,[s("tbody",null,[s("tr",null,[s("td",Ks,[Ps,l(a(o.flavor),1)])]),s("tr",null,[s("td",Qs,[Rs,l(a(o.spicy),1)])]),s("tr",null,[s("td",Ys,[Zs,l(a(o.tableware?"要":"不要"),1)])]),s("tr",null,[s("td",st,[tt,l(a(o.bags?"要":"不要"),1)])]),s("tr",null,[s("td",ot,[at,l(a(o.way?"自取":"外送"),1)])]),s("tr",null,[s("td",dt,[ct,s("span",lt,a(o.time),1)])]),s("tr",null,[s("td",nt,[et,l(a(o.payment?"現金":"線上付款"),1)])]),s("tr",null,[s("td",it,[rt,l(a(o.total),1)])]),s("tr",null,[s("td",_t,[ht,l(a(o.remark),1)])])]),s("tfoot",null,[s("button",{type:"btn",class:"btn btn-primary w-100 mt-1","data-bs-toggle":"modal","data-bs-target":"#finish"+c}," 完成 ",8,ut)])])])])])],8,qs)])]),s("div",{class:"modal fade",id:"finish"+c,"data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"staticBackdropLabel","aria-hidden":"true"},[l(" 0 "),s("div",pt,[s("div",ft,[mt,s("div",yt,[gt,s("button",{type:"button",class:"btn btn-primary","data-bs-dismiss":"modal",onClick:p=>r.pushForCustomer(o.id,o.userId,o.orderNum)}," 確認 ",8,vt)])])])],8,bt)])]))),128))])):F("",!0)]),_:1})])}const Bt=B(E,[["render",kt],["__scopeId","data-v-778771c3"]]);export{Bt as default};
